{"version":3,"sources":["BottomSheetModal.tsx"],"names":["React","forwardRef","memo","useCallback","useImperativeHandle","useMemo","useRef","useState","Portal","usePortal","nanoid","BottomSheet","useBottomSheetModalInternal","print","DEFAULT_STACK_BEHAVIOR","DEFAULT_ENABLE_DISMISS_ON_CLOSE","BottomSheetModalComponent","BottomSheetModal","props","ref","name","stackBehavior","enableDismissOnClose","onDismiss","_providedOnDismiss","index","snapPoints","enablePanDownToClose","onChange","_providedOnChange","children","bottomSheetProps","mount","setMount","containerHeight","containerOffset","mountSheet","unmountSheet","willUnmountSheet","removePortal","unmountPortal","bottomSheetRef","currentIndexRef","restoreIndexRef","minimized","forcedDismissed","mounted","key","resetVariables","component","method","current","unmount","_mounted","handleSnapToIndex","args","snapToIndex","handleSnapToPosition","snapToPosition","handleExpand","expand","handleCollapse","collapse","handleClose","close","handleForceClose","forceClose","handlePresent","requestAnimationFrame","handleDismiss","animationConfigs","params","handleMinimize","handleRestore","handlePortalOnUnmount","handleBottomSheetOnChange","_index","handleBottomSheetOnClose","dismiss","present","minimize","restore","displayName"],"mappings":"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","sourcesContent":["import React, {\n  forwardRef,\n  memo,\n  useCallback,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { Portal, usePortal } from '@gorhom/portal';\nimport { nanoid } from 'nanoid/non-secure';\nimport BottomSheet from '../bottomSheet';\nimport { useBottomSheetModalInternal } from '../../hooks';\nimport { print } from '../../utilities';\nimport {\n  DEFAULT_STACK_BEHAVIOR,\n  DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n} from './constants';\nimport type { BottomSheetModalMethods, BottomSheetMethods } from '../../types';\nimport type { BottomSheetModalProps } from './types';\n\ntype BottomSheetModal = BottomSheetModalMethods;\n\nconst BottomSheetModalComponent = forwardRef<\n  BottomSheetModal,\n  BottomSheetModalProps\n>(function BottomSheetModal(props, ref) {\n  const {\n    // modal props\n    name,\n    stackBehavior = DEFAULT_STACK_BEHAVIOR,\n    enableDismissOnClose = DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n    onDismiss: _providedOnDismiss,\n\n    // bottom sheet props\n    index = 0,\n    snapPoints,\n    enablePanDownToClose = true,\n\n    // callbacks\n    onChange: _providedOnChange,\n\n    // components\n    children,\n    ...bottomSheetProps\n  } = props;\n\n  //#region state\n  const [mount, setMount] = useState(false);\n  //#endregion\n\n  //#region hooks\n  const {\n    containerHeight,\n    containerOffset,\n    mountSheet,\n    unmountSheet,\n    willUnmountSheet,\n  } = useBottomSheetModalInternal();\n  const { removePortal: unmountPortal } = usePortal();\n  //#endregion\n\n  //#region refs\n  const bottomSheetRef = useRef<BottomSheet>(null);\n  const currentIndexRef = useRef(-1);\n  const restoreIndexRef = useRef(-1);\n  const minimized = useRef(false);\n  const forcedDismissed = useRef(false);\n  const mounted = useRef(true);\n  //#endregion\n\n  //#region variables\n  const key = useMemo(() => name || `bottom-sheet-modal-${nanoid()}`, [name]);\n  //#endregion\n\n  //#region private methods\n  const resetVariables = useCallback(function resetVariables() {\n    print({\n      component: BottomSheetModal.name,\n      method: resetVariables.name,\n    });\n    currentIndexRef.current = -1;\n    restoreIndexRef.current = -1;\n    minimized.current = false;\n    mounted.current = true;\n    forcedDismissed.current = false;\n  }, []);\n  const unmount = useCallback(\n    function unmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: unmount.name,\n      });\n      const _mounted = mounted.current;\n\n      // reset variables\n      resetVariables();\n\n      // unmount sheet and portal\n      unmountSheet(key);\n      unmountPortal(key);\n\n      // unmount the node, if sheet is still mounted\n      if (_mounted) {\n        setMount(false);\n      }\n\n      // fire `onDismiss` callback\n      if (_providedOnDismiss) {\n        _providedOnDismiss();\n      }\n    },\n    [key, resetVariables, unmountSheet, unmountPortal, _providedOnDismiss]\n  );\n  //#endregion\n\n  //#region bottom sheet methods\n  const handleSnapToIndex = useCallback<BottomSheetMethods['snapToIndex']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.snapToIndex(...args);\n    },\n    []\n  );\n  const handleSnapToPosition = useCallback<\n    BottomSheetMethods['snapToPosition']\n  >((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.snapToPosition(...args);\n  }, []);\n  const handleExpand = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.expand(...args);\n  }, []);\n  const handleCollapse = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.collapse(...args);\n  }, []);\n  const handleClose = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.close(...args);\n  }, []);\n  const handleForceClose = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.forceClose(...args);\n  }, []);\n  //#endregion\n\n  //#region bottom sheet modal methods\n  const handlePresent = useCallback(\n    function handlePresent() {\n      requestAnimationFrame(() => {\n        if (mount) {\n          bottomSheetRef.current?.snapToIndex(index);\n          return;\n        }\n        setMount(true);\n        mountSheet(key, ref, stackBehavior);\n\n        print({\n          component: BottomSheetModal.name,\n          method: handlePresent.name,\n        });\n      });\n    },\n    [key, index, stackBehavior, mount, ref, mountSheet]\n  );\n  const handleDismiss = useCallback<BottomSheetModalMethods['dismiss']>(\n    function handleDismiss(animationConfigs) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleDismiss.name,\n        params: {\n          currentIndexRef: currentIndexRef.current,\n          minimized: minimized.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      if (\n        minimized.current ||\n        (currentIndexRef.current === -1 && enablePanDownToClose)\n      ) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      forcedDismissed.current = true;\n      bottomSheetRef.current?.forceClose(animationConfigs);\n    },\n    [willUnmountSheet, unmount, key, enablePanDownToClose]\n  );\n  const handleMinimize = useCallback(\n    function handleMinimize() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleMinimize.name,\n        params: {\n          minimized: minimized.current,\n        },\n      });\n      if (minimized.current) {\n        return;\n      }\n      minimized.current = true;\n\n      /**\n       * if modal got minimized before it finish its mounting\n       * animation, we set the `restoreIndexRef` to the\n       * provided index.\n       */\n      if (currentIndexRef.current === -1) {\n        restoreIndexRef.current = index;\n      } else {\n        restoreIndexRef.current = currentIndexRef.current;\n      }\n      bottomSheetRef.current?.close();\n    },\n    [index]\n  );\n  const handleRestore = useCallback(function handleRestore() {\n    print({\n      component: BottomSheetModal.name,\n      method: handleRestore.name,\n      params: {\n        minimized: minimized.current,\n        forcedDismissed: forcedDismissed.current,\n      },\n    });\n    if (!minimized.current || forcedDismissed.current) {\n      return;\n    }\n    minimized.current = false;\n    bottomSheetRef.current?.snapToIndex(restoreIndexRef.current);\n  }, []);\n  //#endregion\n\n  //#region callbacks\n  const handlePortalOnUnmount = useCallback(\n    function handlePortalOnUnmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: handlePortalOnUnmount.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      mounted.current = false;\n      forcedDismissed.current = true;\n\n      if (minimized.current) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      bottomSheetRef.current?.close();\n    },\n    [key, unmount, willUnmountSheet]\n  );\n  const handleBottomSheetOnChange = useCallback(\n    function handleBottomSheetOnChange(_index: number) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnChange.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      currentIndexRef.current = _index;\n\n      if (_providedOnChange) {\n        _providedOnChange(_index);\n      }\n    },\n    [_providedOnChange]\n  );\n  const handleBottomSheetOnClose = useCallback(\n    function handleBottomSheetOnClose() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnClose.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n\n      if (minimized.current) {\n        return;\n      }\n\n      if (enableDismissOnClose) {\n        unmount();\n      }\n    },\n    [enableDismissOnClose, unmount]\n  );\n  //#endregion\n\n  //#region expose methods\n  useImperativeHandle(ref, () => ({\n    // sheet\n    snapToIndex: handleSnapToIndex,\n    snapToPosition: handleSnapToPosition,\n    expand: handleExpand,\n    collapse: handleCollapse,\n    close: handleClose,\n    forceClose: handleForceClose,\n    // modal methods\n    dismiss: handleDismiss,\n    present: handlePresent,\n    // internal\n    minimize: handleMinimize,\n    restore: handleRestore,\n  }));\n  //#endregion\n\n  // render\n  // console.log('BottomSheetModal', index, snapPoints)\n  return mount ? (\n    <Portal key={key} name={key} handleOnUnmount={handlePortalOnUnmount}>\n      <BottomSheet\n        {...bottomSheetProps}\n        ref={bottomSheetRef}\n        key={key}\n        index={index}\n        snapPoints={snapPoints}\n        enablePanDownToClose={enablePanDownToClose}\n        animateOnMount={true}\n        containerHeight={containerHeight}\n        containerOffset={containerOffset}\n        onChange={handleBottomSheetOnChange}\n        onClose={handleBottomSheetOnClose}\n        children={children}\n        $modal={true}\n      />\n    </Portal>\n  ) : null;\n});\n\nconst BottomSheetModal = memo(BottomSheetModalComponent);\nBottomSheetModal.displayName = 'BottomSheetModal';\n\nexport default BottomSheetModal;\n"]}